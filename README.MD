# 📄 打字模拟器项目需求文档（正式版）

---

## 1. 项目背景

本项目旨在开发一款基于 Node.js 后端 + CodeMirror 前端编辑器的**打字模拟器网页应用**，通过逐字符输出的方式模拟真实人类打字体验。

主要应用场景包括：
- 技术展示
- 产品介绍
- 打字动画效果演示
- 代码片段动态呈现

用户希望能通过简单配置，即可实现打字效果的自定义控制，包括代码内容、字体大小、打字速度、行高等。

---

## 2. 项目目标

| 目标 | 说明 |
|:---|:---|
| 打字模拟效果 | 页面打开后，逐字符模拟真实打字 |
| URL参数控制 | 支持动态配置代码文件、字体大小、打字速度、行高 |
| 高度还原 VSCode Darker 主题风格 | 提升阅读体验和美观性 |
| 打字完成即停止 | 打完一次后停止，不循环、不清空 |
| 稳定、易用、无需打包器 | 仅需 Node.js 和浏览器即可运行，无需构建流程 |

---

## 3. 功能需求

### 3.1 基础功能

- 页面加载后，读取 URL 中的 `code` 参数，动态获取并展示对应代码文件内容。
- 支持以下 URL Query 参数控制：
  - `code`: 指定要加载的代码文件（如 example.js）
  - `fontSize`: 控制编辑器文字大小（如16、18、20）
  - `speed`: 控制打字速度（数字越小越快）
  - `lineHeight`: 控制代码行高（如1.4、1.6、2）

### 3.2 打字控制

- 逐字符输出，模拟真实打字节奏。
- 打完全部字符后，停止打字，内容保留在屏幕上。
- 打字过程中允许通过随机延迟制造更自然的人为打字节奏感。

### 3.3 代码读取

- 通过后端 `/api/code?file=xxx` 接口从 `/code/` 目录中读取指定文件内容。
- 若文件不存在，则返回默认文本 "Hello World !"。

### 3.4 编辑器界面要求

- 使用 CodeMirror 5，主题为 `material-darker`。
- 行号开启。
- 编辑器只读（readOnly）。
- 支持 JavaScript、Python、HTML 语言高亮。

---

## 4. 技术实现细节

### 4.1 后端

- 使用 Node.js + Express 搭建本地服务。
- 采用 ES6 Modules（`import`/`export`）规范。
- 动态端口检测（若默认端口3000被占用，自动切换）。
- 服务器启动后，自动打开浏览器访问预设URL。
- 美化终端输出，仿Vite开发体验。

### 4.2 前端

- 仅使用静态 HTML + 原生 JS。
- 通过 jsdelivr CDN 引入 CodeMirror 5 核心库和主题。
- fetch API 请求后端 `/api/code` 接口。
- URL参数解析后应用到编辑器配置。

### 4.3 项目结构

```
/code/               // 示例代码文件存放
  example.js
  example.py
  example.html
index.html            // 前端页面
server.js             // Node.js 后端服务
package.json          // 项目配置
.gitignore            // Git忽略规则
```

---

## 5. 关键非功能性要求

- 快速加载，打开即用，无需复杂部署。
- 页面兼容性好，支持主流现代浏览器（Chrome、Edge、Firefox）。
- 代码结构清晰，便于后期扩展和维护。
- 高鲁棒性，任何异常情况（文件不存在、请求失败）能优雅降级处理。

---

## 6. 未来可扩展方向（可选）

| 方向 | 描述 |
|:---|:---|
| ✅ 多文件自动轮播 | 多个示例代码文件，打完后自动切换（已实现：通过URL参数`loop=true`开启） |
| 打字节奏加速 | 模拟人打字，越打越快（加速打字） |
| 打字音效 | 敲击音效果（提升沉浸感） |
| 主题切换 | 支持暗黑/亮色模式自动切换 |
| 支持Markdown高亮 | 新增对 Markdown(.md) 文件打字演示 |
| 移动端优化 | 响应式布局，适配小屏幕设备展示 |
| 配置化加载 | 支持json配置批量加载不同文件或打字任务 |
| 本地文件拖拽上传 | 拖拽上传本地代码文件，自动播放打字 |

